<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –ê–¥–º–∏–Ω–∫–∏</title>
    <style>
        body { 
            font-family: Arial; 
            padding: 20px; 
            background: #1a1a1a; 
            color: white; 
        }
        button { 
            padding: 15px 30px; 
            font-size: 16px; 
            margin: 10px; 
            cursor: pointer;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
        }
        #result { 
            margin-top: 20px; 
            padding: 20px; 
            background: #2a2a2a; 
            border-radius: 8px;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        pre { background: #000; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ê–¥–º–∏–Ω–∫–∏</h1>
    
    <h2>–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API</h2>
    <button onclick="testHealth()">–¢–µ—Å—Ç /api/health</button>
    <button onclick="testAdmin()">–¢–µ—Å—Ç –∞–¥–º–∏–Ω–∞ @ebashordie</button>
    <button onclick="testPartners()">–¢–µ—Å—Ç —Å—Å—ã–ª–æ–∫</button>
    
    <h2>–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</h2>
    <button onclick="checkElements()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã DOM</button>
    <button onclick="showAdminPanel()">–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω–∫—É</button>
    
    <div id="result"></div>

    <script>
        const API_URL = 'http://127.0.0.1:8787';
        const resultDiv = document.getElementById('result');

        function log(message, type = 'info') {
            const color = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
            resultDiv.innerHTML += `<div class="${color}">${message}</div>`;
        }

        async function testHealth() {
            resultDiv.innerHTML = '<h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ /api/health...</h3>';
            try {
                const response = await fetch(`${API_URL}/api/health`);
                const data = await response.json();
                log('‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
                log(`<pre>${JSON.stringify(data, null, 2)}</pre>`);
            } catch (error) {
                log('‚ùå API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: ' + error.message, 'error');
            }
        }

        async function testAdmin() {
            resultDiv.innerHTML = '<h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞ @ebashordie...</h3>';
            try {
                const response = await fetch(`${API_URL}/api/me`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: 'ebashordie' })
                });
                const data = await response.json();
                
                if (data.is_admin) {
                    log('‚úÖ –í–´ –ê–î–ú–ò–ù!', 'success');
                } else {
                    log('‚ùå –ù–ï –ê–î–ú–ò–ù!', 'error');
                }
                log(`<pre>${JSON.stringify(data, null, 2)}</pre>`);
            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
        }

        async function testPartners() {
            resultDiv.innerHTML = '<h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫...</h3>';
            try {
                const response = await fetch(`${API_URL}/api/partners`);
                const data = await response.json();
                log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.length} —Å—Å—ã–ª–æ–∫`, 'success');
                log(`<pre>${JSON.stringify(data.slice(0, 3), null, 2)}</pre>`);
            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
        }

        function checkElements() {
            resultDiv.innerHTML = '<h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ index.html...</h3>';
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º index.html –≤ iframe –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = '/index.html';
            document.body.appendChild(iframe);
            
            setTimeout(() => {
                try {
                    const doc = iframe.contentDocument || iframe.contentWindow.document;
                    
                    const adminBtn = doc.getElementById('adminBtn');
                    const adminPanel = doc.getElementById('adminPanel');
                    
                    if (adminBtn) {
                        log('‚úÖ –ö–Ω–æ–ø–∫–∞ "–ê–¥–º–∏–Ω–∫–∞" –Ω–∞–π–¥–µ–Ω–∞', 'success');
                        log(`   Display: ${window.getComputedStyle(adminBtn).display}`);
                    } else {
                        log('‚ùå –ö–Ω–æ–ø–∫–∞ "–ê–¥–º–∏–Ω–∫–∞" –ù–ï –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                    
                    if (adminPanel) {
                        log('‚úÖ –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∫–∏ –Ω–∞–π–¥–µ–Ω–∞', 'success');
                        log(`   Display: ${window.getComputedStyle(adminPanel).display}`);
                    } else {
                        log('‚ùå –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∫–∏ –ù–ï –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                    
                    document.body.removeChild(iframe);
                } catch (error) {
                    log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã: ' + error.message, 'error');
                    log('–û—Ç–∫—Ä–æ–π—Ç–µ index.html –∏ –Ω–∞–∂–º–∏—Ç–µ F12 –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'info');
                }
            }, 1000);
        }

        function showAdminPanel() {
            window.open('/index.html', '_blank');
            resultDiv.innerHTML = '<h3>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h3>';
            log('1. –û—Ç–∫—Ä–æ–µ—Ç—Å—è index.html –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ');
            log('2. –ù–∞–∂–º–∏—Ç–µ F12 (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è DevTools)');
            log('3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Console');
            log('4. –í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É:');
            log('<pre>document.getElementById("adminPanel").style.display = "block";</pre>');
            log('5. –ù–∞–∂–º–∏—Ç–µ Enter');
            log('6. –ê–¥–º–∏–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è!');
        }
    </script>
</body>
</html>
